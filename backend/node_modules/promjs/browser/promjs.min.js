var promjs=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t){var e=Object.entries(t.labels||{}).map((function(t){var e=r(t,2),n=e[0],o=e[1];return"".concat(n,'="').concat(o,'"')}));return 0===e.length?"":"".concat(e.join(","))}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t?e.find((function(e){if(!e.labels)return!1;if(Object.keys(e.labels||{}).length!==Object.keys(t).length)return!1;for(var n=Object.entries(t),o=0;o<n.length;o+=1){var u=r(n[o],2),i=u[0],a=u[1];if(e.labels[i]!==a)return!1}return!0})):e[0]}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",(function(){return H}));var c=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=void 0,(e="data")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n,this.data=[]}var e,n;return e=t,(n=[{key:"get",value:function(t){return u(t,this.data)}},{key:"set",value:function(t,e){var n=u(e,this.data);return n?n.value=t:this.data.push({labels:e,value:t}),this}},{key:"collect",value:function(t){return t?this.data.filter((function(e){if(!e.labels)return!1;for(var n=Object.entries(t),r=0;r<n.length;r+=1){var o=i(n[r],2),u=o[0],a=o[1];if(e.labels[u]!==a)return!1}return!0})):this.data}},{key:"resetAll",value:function(){for(var t=0;t<this.data.length;t+=1)this.reset(this.data[t].labels);return this}}])&&a(e.prototype,n),t}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){function e(){return f(this,e),y(this,b(e).apply(this,arguments))}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,t),n=e,(r=[{key:"inc",value:function(t){return this.add(1,t),this}},{key:"add",value:function(t,e){if(t<0)throw new Error("Expected increment amount to be greater than -1. Received: ".concat(t));var n=this.get(e);return this.set(n?n.value+t:t,e),this}},{key:"reset",value:function(t){this.set(0,t)}}])&&s(n.prototype,r),e}(c);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var j=function(t){function e(){return d(this,e),m(this,w(e).apply(this,arguments))}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,t),n=e,(r=[{key:"dec",value:function(t){var e=this.get(t);return this.set(e?e.value-1:0,t),this}},{key:"sub",value:function(t,e){var n=this.get(e);return this.set(n?n.value-t:0,e),this}}])&&g(n.prototype,r),e}(p);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?x(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){return{entries:t.reduce((function(t,e){return t[e.toString()]=0,t}),{"+Inf":0}),sum:0,count:0,raw:[]}}var C=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _(this,e),A(x(t=P(this,E(e).call(this))),"buckets",void 0),t.buckets=n.sort((function(t,e){return t>e?1:-1})),t.set(I(t.buckets)),t.observe=t.observe.bind(x(t)),t}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(e,t),n=e,(r=[{key:"observe",value:function(t,e){var n=this.get(e);null==n&&(n=this.set(I(this.buckets),e).get(e)),n.value.raw.push(t),n.value.entries["+Inf"]+=1;var r=function(t,e){if(e<t[t.length-1])for(var n=0;n<t.length;n+=1)if(e<=t[n])return n}(this.buckets,t);if(null!=r)for(var o=r;o<this.buckets.length;o+=1){var u=n.value.entries[this.buckets[o].toString()];n.value.entries[this.buckets[o].toString()]=u+1}return n.value.sum=n.value.raw.reduce((function(t,e){return t+e}),0),n.value.count+=1,this}},{key:"reset",value:function(t){this.set(I(this.buckets),t)}}])&&S(n.prototype,r),e}(c);function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=void 0,(e="data")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n,this.data={counter:{},gauge:{},histogram:{}}}var e,n;return e=t,(n=[{key:"validateInput",value:function(t,e,n,r){if(""===String(e))throw new Error("Metric name cannot be empty");if(-1===["counter","gauge","histogram"].indexOf(t))throw new Error("Unknown metric type ".concat(t));if("string"!=typeof n&&null!=n)throw new Error("help must be string or undefined/null");if(this.data[t][e])throw new Error("A metric with the name '".concat(e,"' already exists for type '").concat(t,"'"));if(!Array.isArray(r)&&null!=r)throw new Error("buckets must be array or undefined/null")}},{key:"create",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return this.validateInput(t,e,r,o),"counter"===t?(n=new p,this.data.counter[e]={help:r,instance:n,type:t}):"gauge"===t?(n=new j,this.data.gauge[e]={help:r,instance:n,type:t}):(n=new C(o),this.data.histogram[e]={help:r,instance:n,type:t}),n}},{key:"metrics",value:function(){return Object.entries(this.data).reduce((function(t,e){var n=M(e,2),u=n[0],i=n[1];return t+Object.entries(i).reduce((function(t,e){var n=M(e,2),i=n[0],a=n[1],c=a.instance.collect(),l=t;return a.help.length>0&&(l+="# HELP ".concat(i," ").concat(a.help,"\n")),(l+="# TYPE ".concat(i," ").concat(u,"\n"))+c.reduce((function(t,e){return t+("histogram"===u?function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"le",u="",i=o(e);return i.length>0?(u+="".concat(t,"_count{").concat(i,"} ").concat(e.value.count,"\n"),u+="".concat(t,"_sum{").concat(i,"} ").concat(e.value.sum,"\n")):(u+="".concat(t,"_count ").concat(e.value.count,"\n"),u+="".concat(t,"_sum ").concat(e.value.sum,"\n")),Object.entries(e.value.entries).reduce((function(e,o){var u=r(o,2),a=u[0],c=u[1];return i.length>0?"".concat(e).concat(t,"_bucket{").concat(n,'="').concat(a,'",').concat(i,"} ").concat(c,"\n"):"".concat(e).concat(t,"_bucket{").concat(n,'="').concat(a,'"} ').concat(c,"\n")}),u)}(i,e):function(t,e){var n=" ".concat(e.value.toString());if(null==e.labels||0===Object.keys(e.labels).length)return"".concat(t).concat(n,"\n");var o=Object.entries(e.labels).map((function(t){var e=r(t,2),n=e[0],o=e[1];return"".concat(n,'="').concat(o,'"')}));return"".concat(t,"{").concat(o.join(","),"}").concat(n,"\n")}(i,e))}),"")}),"")}),"")}},{key:"reset",value:function(){return Object.values(this.data).map((function(t){return Object.values(t).map((function(t){return t.instance.resetAll()}))})),this}},{key:"clear",value:function(){return this.data={counter:{},gauge:{},histogram:{}},this}},{key:"get",value:function(t,e){var n=(null!=t?[this.data[t]]:Object.values(this.data)).find((function(t){return e in t}));return null!=n?n[e].instance:void 0}}])&&R(e.prototype,n),t}()},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(0);for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);e.default=function(){return new r.a}}]);